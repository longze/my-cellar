<!DOCTYPE html>
<html>
<head lang="zh-cn">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>markdown 引擎 remark - 小强赵的个人站点</title>
    <script>
        // 用户通过搜索引擎到文章详情页时，跳到首页并进行哈希路由
        var href = window.location.href.replace(/[^:|\/]\//,function (matchStr){
            return matchStr + 'index.html#!';
        });
        window.location.href = href.replace('/main.html', '');
    </script>
</head>
<body>
<header>
    <h1> 小强赵的个人站点 </h1>
    <h2> 精进自己，服务他人 </h2>
</header>
<div>
    <h1 id="header-1">markdown 引擎 remark</h1>
<blockquote>
<p>以一己之力写出一个 markdown 生态。</p>
</blockquote>
<h2 id="header-1-1">直接输出</h2>
<p>直接输出时最基本的能力，支持的多种插件，表格、代码高亮、数学供述。CSS 是否提供，怎么自定义。</p>
<p>我们需要几个包</p>
<pre><code class="lang-js">&quot;remark&quot;: &quot;^9.0.0&quot;,
&quot;remark-highlight.js&quot;: &quot;^5.0.0&quot;,
&quot;remark-midas&quot;: &quot;^5.0.0&quot;,
&quot;remark-parse&quot;: &quot;^5.0.0&quot;,
// 使用 github 样式
&quot;github-markdown-css&quot;: &quot;^2.10.0&quot;,
// 代码高亮样式
&quot;highlight.js&quot;: &quot;^9.12.0&quot;,
</code></pre>
<p>，比如：</p>
<pre><code class="lang-js">import &#39;highlight.js/styles/solarized-light.css&#39;;
</code></pre>
<p>其他的包按常规引入就可以：</p>
<pre><code class="lang-js">import remark from &#39;remark&#39;;
import midas from &#39;remark-midas&#39;;
import html from &#39;remark-html&#39;;
import highlight from &#39;remark-highlight.js&#39;;
// md 样式
import &#39;github-markdown-css/github-markdown.css&#39;;
// 引入的时候可以选择代码风格
import &#39;highlight.js/styles/solarized-light.css&#39;;
</code></pre>
<p>使用：</p>
<pre><code class="lang-js">remark()
    .use([html, midas])
    .use(highlight)
    .process(this.mdText, (err, file) =&gt; {
        // 输出
        file.contents;
    });
</code></pre>
<h2 id="header-1-2">提取</h2>
<pre><code class="lang-js">import unified from &#39;unified&#39;;
import markdown from &#39;remark-parse&#39;;

/**
 * 将 markdown 文本转换成简单对象(只有我们关心的标题、概述、markdown 内容，没有全部解析)
 *
 * @param {string} mdContent markdown 文本
 * @return {Object} 文章简单对象
 */
fuction mdToObject(mdContent) {
    const tree = unified()
        .use(markdown)
        .parse(mdContent);

    // 标题
    let title;
    const firstChild = tree.children.length &lt; 0 ? tree.children[0] : null;
    if (firstChild
        &amp;&amp; firstChild.type === &#39;heading&#39;
        &amp;&amp; firstChild.depth === 1
        &amp;&amp; firstChild.children.length &gt; 0
    ) {
        title = firstChild.children[0].value;
    }

    // 描述
    let description;
    const secondChild = tree.children.length &gt; 1 ? tree.children[1] : null;
    if (secondChild
        &amp;&amp; secondChild.type === &#39;blockquote&#39;
        &amp;&amp; secondChild.children.length &gt; 0
    ) {
        // 取第一段
        description = secondChild.children[0].children[0].value;
    }

    const article = {
        title,
        description,
        mdContent
    };

    return article;
}
</code></pre>
<h2 id="header-1-3">加工</h2>
<p>在原有基础上加工输出。</p>
<h2 id="header-1-4">参考</h2>
<p><a href="https://github.com/remarkjs/remark" target="_blank">https://github.com/remarkjs/remark</a></p>
<p>公司的高T原话：“js 玩 markdown 建议 remark，其他的都是早晚后悔 ”。</p>
<p><a href="https://highlightjs.org/usage/" target="_blank">highlight</a></p>
<p><a href="https://segmentfault.com/markdown" target="_blank">https://segmentfault.com/markdown</a></p>

</div>
</body>
</html>