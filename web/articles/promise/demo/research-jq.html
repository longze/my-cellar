<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>测试jQuery的Ajax 对 Promise的支持</title>
    <script src="jquery-2.1.4.js"></script>
</head>
<body>
<script>

    function test1() {
        $.ajax({
            url: '/login2',
            success: function (data) {
                console.log('1--' + data.info);
            },
            error: function () {
                console.log('1--粗错鸟');
            }
        });
    }
    //test1();

    function test2() {
        $.ajax({
            url: '/login'
        }).done(function (data) {
            console.log('2--' + data.info);
        }).fail(function () {
            console.log('2--粗错鸟');
        });
    }
    //test2();

    function test3() {
        $.ajax({
            url: '/login'
        }).then(function (data) {
            console.log('3--' + data.info);
        }, function () {
            console.log('3--粗错鸟');
        });
    }
    //test3();

    function test4() {
        var user = {};
        $.ajax({
            url: '/login'
        }).then(function (data) {
            user.id = data.data;
            return $.ajax('/get-current-user-info');
        }).then(function (data) {
            user.name = data.data.name;
        }, function () {
            console.log('获取当前用户登录信息失败');
        });
    }
    test4();

    function test5() {

        $.ajax({
            url: '/login'
        }).then(function (data) {
            console.log(data.info);
        }).then(function () {
            return $.ajax('/get-current-user-info');
        }).then(function (data) {
            console.log('用户名:' + data.data.name);
        }).then(function (data) {
            console.log('一个对列上的then:' + data.data.name);
        }).then(function () {
            return $.ajax('/exit');
        }).then(function (data) {
            console.log(data.info);
        });
    }
    //test5();


</script>
</body>
</html>
