# 《鸟哥的 Linux 私房菜》读书笔记

> 为了不底层基础大的更牢靠，阅读以下系统相关的书是必要的，由于这本书没有电子版发行，这篇是阅读纸质版的笔记，方便查阅和自我梳理。

## Linux 的规则和安装

历史回顾 -- 程序员是个年轻的职业：

- 1985 年 Windows 1.0 发布；
- 1996 年 Linux 1.0 正式上线。

之前的计算机基本是实验室里东西，实际使用单位也只有不差钱的政府和研究性质的高校。

Linux 能干啥 -- 企业应用，网路服务，企业网络管理。

如何学习 Linux -- 如果只想“会使用”Linux，那么 X Window 也足够了；如果想深入学习 Linux，那么命令行才是学习的不二方式。

Linux 的安装可以在 Virtuabox 中练习，练习一些系统初始化的设置，现在一般是云服务器，提交一个配置表单提供方就直接重装了，所以这里不展开。

Linux 下的两种桌面环境：GNOME[nəʊm], KDE(Kool Desktop Environment)。

然后是几个基础的命令，有的时候装某些软件有对系统的要求：

```shell
# 查看 Linux 内核版本，有时也叫 binaries
uname -a
# 结果：3.10.0_3-0-0-11 CST 2015 x86_64 x86_64 x86_64 GNU/Linux

# 查看 centos 版本
cat /etc/issue
# 结果：CentOS release 6.3
```

然后就是用 `man` 来获取命令的帮助，比如：

```shell
man cat
```
最后记住忘了 root 密码不用重装系统也能搞定，但愿你永远用不到。什么？你担心不安全？哦，可以通过加堡垒机之类的方案做增强。

## 文件与目录

### 那些重要的文件 与 FHS

`/etc/` 下存放系统的重要配置，其中 `/etc/shadow` 存放所有的用户名和密码，当然只有 root 权限才能看，密码当让也是加过密的。

`/etc/group` 中存放的是用户组信息。

`/etc/profile` 中存放全局的环境变量。可以在文件的 `Path manipulation` 部分修改。

除了上面这些系统定义好的文件与文件夹之外，Linux 对软件和用户也提出了规范 -- FHS(Filesystem Hierarchy Standard)。

比如 `/home/` 下，放用户目录，在新建用户的时候 CentOS 6.3 会自动在 `/home/` 下创建同名目录(CentOS 4.3需要手动创建)。

比如 `/usr/local`，建议管理员将软件安装到这里，Redis 和 MondoDB 都是这么建议的。

### 文件权限

说到文件权限，就不得不提用户和用户组的相关内容，但是这里我们花开两朵各表一枝，先说文件权限，假设所有用户和用户组以及两者之间的关系已经确定不变。

Linux 作为多用户操作系统文件权限是其保证安全的根本。怎么查看一个文件或文件夹的权限呢？

```shell
ls -al
ll -a
# 比如 /home/ 下我自己的目录是下面这样
drwx------ 11 longze    longze  4096     Dec 22 20:17 longze
[权限]   [连接] [所有者]  [用户组] [文件容量] [修改日期]    [文件名]
```

两条命令等价，第一个字母代表文件类型：

- `d` 代表文件夹;
- `-` 代表文件;
- `l` 代表引用。

之后的 9 个字母分成三组，每三个字母一组，分别对应“文件主”、“组用户”、“其他用户”:

- `r` 代表只读；
- `w` 代表写；
- `x` 代表可执行；
- `-` 代表空许可。

用 `chmod` 可变更权限，如 `chmod o+w,g+w longze`：

- `u` 表示“用户（user）”，即文件或目录的所有者。
- `g` 表示“同组（group）用户”，即与文件属主有相同组ID的所有用户。
- `o` 表示“其他（others）用户”。
- `a` 表示“所有（all）用户”。它是系统默认值。

改变文件的所有者和用户组，加 `-R` 参数可修改子目录下的全部文件权限：

```shell
# 改变 owner
chown -R 用户名 文件(夹)名
# 改变 group
chgrp -R 用户组名 文件(夹)名
```

### 文件与目录管理

先来一组基础命令

```shell
# 查看当前路径
pwd
# 新建文件夹
mkdir -p a/b/c
# 删除文件夹及其内部的全部内容
rm -rf 文件夹名称
# 复制，复制文件夹以及里面的内容加参数 -r，联通文件属性复制加 -p
cp -rp 源文件 目标文件
# 移动文件，文件更名
mv 源文件 目标文件
# 从远程下载文件
wget
# 新建文件，
touch text
# 读文件
cat text
# 在当前目录以及其子目录下有没有一个 text 文件
find ./ -name text
```

有些命令我们在任何地方都可以执行，这归功于环境变量，可以用 `echo` 将此变量打印出来查看：

```shell
echo $PATH
# 结果：/usr/local/bin:/usr/bin:/bin
```

当我们执行一个命令的时候，Linux 会从上面的那些文件夹中(以冒号间隔)查找有没有我们输入的命令对应的可执行文件，如果找到了就执行。想要对所有户都生效修改 `/etc/profile` 文件，想要对当前用户生效修改 `~/.bash_profile` 文件，修改的方式都是在行尾加上一行：

```shell
# 添加某某环境变量
export PATH=$PATH:自定义路径
```

如果想知道命令 `ls` 具体在哪里可以用 `which ls` 命令。

还有一个文件默认权限的设置 umask，查看默认权限有下面两种形式：

```shell
umas
# 结果：0002
umas -S
# 结果：u=rwx,g=rwx,o=rx
```

0002 的第一位是特殊权限先不管他，后面的 002 对应 u=rwx,g=rwx,o=rx。rwx 对应 421，然后用默认全有的 7 减去有的权限就是看到的数字。所以有一个大招叫 `chmod 777`。重新设置也很简单：

```shell
umask 000
umask -S
# 结果：u=rwx,g=rwx,o=rwx
```

### 磁盘与文件系统

inode 记录索引和权限，block 存储具体的内容。还有一些分区和挂载相关的内容都已经工具化了，这里的原理简单了解就好，不详诉。

