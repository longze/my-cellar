<!DOCTYPE html>
<html>
<head lang="zh-cn">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>npm - 龙则的博客站点</title>
    <script>
        // 用户通过搜索引擎到文章详情页时，跳到首页并进行哈希路由
        var href = window.location.href.replace(/[^:|\/]\//,function (matchStr){
            return matchStr + 'index.html#!';
        });
        window.location.href = href.replace('/main.html', '');
    </script>
</head>
<body>
<header>
    <h1>
        龙则个人站点
    </h1>

    <h2>
        记录工作与生活的所得所感
    </h2>
</header>
<div>
    <h1 id="header-1">npm</h1>
<blockquote>
<p>NodeJs 的默认包管理器。</p>
</blockquote>
<h2 id="header-1-1">常用命令</h2>
<p>为新手注：如果是Mac，遇到权限问题前面加 <code>sudo</code>，如果需要密码则为开机密码。</p>
<p>查看npm版本</p>
<pre><code>npm -v
</code></pre><p>更新NPM版本</p>
<pre><code>npm install npm -g
</code></pre><p>安装全局包(以gulp为例，下同)</p>
<pre><code>npm install gulp -g
</code></pre><p>局部安装</p>
<pre><code>npm install gulp
</code></pre><p>安装某一版本</p>
<pre><code>npm install gulp@3.7.0 -g
npm install gulp@3.7.0
</code></pre><p>查看全局包是否被安装及版本号</p>
<pre><code>gulp -v
// 如果安装了会显示版本号，如果没有安装会显示
// “bash: /usr/local/bin/gulp: No such file or directory”
</code></pre><p>卸载全局包 <code>gulp</code></p>
<pre><code>npm uninstall gulp -g
</code></pre><p>初始化一个 package.json </p>
<pre><code>npm init
</code></pre><p>安装 package.json 中配置的包</p>
<pre><code>npm install
</code></pre><h2 id="header-1-2">一些说明</h2>
<p>只有全局安装的包才可以直接使用命令行，但是并不是所有包都提供命令行功能，在 <code>/usr/local/bin</code> 路径下有相关文件的才能提供命令行功能，但是该文件夹一般为隐藏文件夹。</p>
<p>局部安装的包并非一定不能使用命令行，只是稍微间接一点，以gulp为例，可以在安装目录下这样使用命令行：</p>
<pre><code> ./node_modules/gulp/bin/gulp.js
</code></pre><p>来使用命令行。我们通过问答的形式将这个问题深入一下，</p>
<p>问：明明是个js文件为什么可以当做命令来使用？</p>
<p>答：因为js本身就是脚本，当然可以直接运行。</p>
<p>问：那我写个js文件，比如my.js，内容如下，可以直接运行吗？</p>
<pre><code>console.log(&#39;Hi&#39;);
</code></pre><p>答：不行，需要做脚本声明才可以，你看一下gulp.js 第一行就是，代码如下：</p>
<pre><code>#!/usr/bin/env node
</code></pre><p>问：噎，我加了为什么还是不行？</p>
<p>答：需要赋权限，代码如下，这个命令的详细解释看<a href="http://lucky16.iteye.com/blog/577182" target="_blank">这篇</a>文章。    </p>
<pre><code>chmod a+x my.js
</code></pre><p>问：直接这样吗？</p>
<pre><code>my.js
</code></pre><p>答：需要下面这样：</p>
<pre><code>./my.js
</code></pre><p>问：这次真的可以了吗？好麻烦，这么多坑</p>
<p>答：当然可以了！其实上面这些配置是在 <code>npm install xxx</code> 的时候就做好了不需要手动配置，如果你要开发命令行工具可以去查看<a href="http://javascriptplayground.com/blog/2012/08/writing-a-command-line-node-tool/" target="_blank">这篇文章</a>。</p>
<h2 id="header-1-3">一个包的构成</h2>
<p>package.json 描述文件，包括包的介绍，版本，依赖，作者，git 和 npm 等信息。</p>
<p>CHANGELOG.md 存放包升级时个版本的改动。</p>
<p>LICENCE 许可协议</p>
<p>README.md 包的使用说明书</p>
<p>bin 文件夹用来存放此包的实现代码。</p>
<p>node_modules 文件夹用来存放当前包所以来的包。</p>
<p>上面所有的这些都是可选的，一个符合 CommonJs 规范的 js 文件就可以作为一个包来使用，为了托管 npm 的统一制定了上面规范，如果你不考虑别人能不能看的懂 和 看的爽不爽 你可以忽略任何一条。</p>
<p>npm WARN package.json demo@ No repository field.</p>
<pre><code>&quot;repository&quot;: {
  &quot;type&quot;: &quot;git&quot;,
  &quot;url&quot;: &quot;git://github.com/username/repository.git&quot;
},
// 或者这样也可以
&quot;private&quot;: true
</code></pre><p>npm WARN package.json demo@ No README data</p>
<p>npm WARN package.json demo@ No license field.</p>
<h2 id="header-1-4">dependencies和devDependencies的区别</h2>
<p>一个node package有两种依赖，一种是dependencies一种是devDependencies，其中前者依赖的项该是正常运行该包时所需要的依赖项，而后者则是开发的时候需要的依赖项，像一些进行单元测试之类的包。</p>
<p>如果你将包下载下来在包的根目录里运行</p>
<pre><code>npm install
</code></pre><p>默认会安装两种依赖，如果你只是单纯的使用这个包而不需要进行一些改动测试之类的，可以使用</p>
<pre><code>npm install --production
</code></pre><p>只安装dependencies而不安装devDependencies。</p>
<p>如果你是通过以下命令进行安装</p>
<pre><code>npm install packagename
</code></pre><p>那么只会安装dependencies，如果想要安装devDependencies，需要输入</p>
<pre><code>npm install packagename --dev 
</code></pre><h2 id="header-1-5">写一个包贡献给全世界</h2>
<p>待续...</p>
<h2 id="header-1-6">一些技巧</h2>
<p>安装国内的镜像npm，可使安装更快，15分钟与国外同步一次</p>
<pre><code>npm install -g cnpm --registry=http://registry.npm.taobao.org
</code></pre><p>--save 与 --save-dev</p>
<p>当为模块安装一个依赖模块时，正常情况下得先安装他们（在模块根目录下npm install module-name），然后连同版本号手动将他们添加到模块配置文件package.json中的依赖里（dependencies）。</p>
<p>-save和save-dev可以省掉你手动修改package.json文件的步骤。</p>
<p><code>spm install module-name -save</code> 自动把模块和版本号添加到dependencies部分。</p>
<p><code>spm install module-name -save-dve</code> 自动把模块和版本号添加到devdependencies部分。</p>
<p>至于配置文件区分这俩部分， 是用于区别开发依赖模块和产品依赖模块，devDepandencies主要是配置测试框架， 例如jshint、mocha。</p>
<h2 id="header-1-7">更新 node</h2>
<p>node有一个模块叫n（这名字可够短的。。。），是专门用来管理node.js的版本的。首先安装n模块：</p>
<pre><code>npm install -g n
</code></pre><p>然后升级node.js到最新稳定版</p>
<pre><code>n stable
</code></pre><h2 id="header-1-8">参考资料</h2>
<p><a href="http://segmentfault.com/a/1190000000471219" target="_blank">淘宝 NPM 镜像</a></p>
<p><a href="https://cnodejs.org/topic/4f9904f9407edba21468f31e" target="_blank">npm国内镜像介绍</a></p>
<p><a href="https://www.npmjs.org/doc/json.html" target="_blank">package.json</a></p>
<p><a href="https://www.npmjs.org/doc/cli/npm-install.html" target="_blank">npm-install</a></p>

</div>
</body>
</html>